<!DOCTYPE><html><head><link href="favic32.ico" rel="shortcut icon" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/angular-1.6.4/angular.min.js"></script>
<script src="/angular-1.6.4/angular-sanitize.min.js"></script>
<script src="/angular-1.6.4/angular-md5.js"></script>
<script src="/angular-1.6.4/angular-ui-router.js"></script>
	<script src="main.js"></script>

<!-- template.XL dependencies-->
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/shim.js"></script>
<script type="text/javascript" src="../xlsx.full.min.js"></script>

<!-- FileSaver.js is the library of choice for Chrome -->
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/Blob.js"></script>
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/FileSaver.js"></script>
<script type="text/javascript" src="xlContract.js"></script>
<!-- FileSaver doesn't work in older IE and newer Safari; Downloadify is the flash fallback -->
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/swfobject.js"></script>
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/downloadify.min.js"></script>
<script type="text/javascript" src="/aswan/2017/12/SheetJS JS-XLSX In-Browser HTML Table Export Demo_files/base64.min.js"></script>

<!-- end of template.XL dependencies-->

<title>Aswan 2017, by mohamadjb@gmail.com</title>
<link rel="stylesheet" href="main.css">
</head>
<body class="grad">
<div style="position:absolute;top:0;left:0;x-width:1600px;min-width:250px;min-height:250px;x-height:847px;width:100%;height:100%;background-image:url(ab_left.png);z-index: -10"></div>
<img class="onLoggedOut" src="logo.png">
<span class="onLoggedIn"><div width="100%" style="display:inline-flex ;
    grid-gap: 3px;
    grid-auto-rows: minmax(100px,auto);
    grid-template-columns: repeat({{app.usr.f?6:2}},1fr);
    background: rgba(240,240,255,.1);
    border-radius: 5px;
    padding: 3px;">
	<div class="menuItem" style="min-width:300px"><img src="logo.png"></div>
	<div class="menuItem bvl"><a href="#!/main">Contracts</a></div>
	<div class="menuItem bvl onUsrF" ><a href="#!/cntrctsReport">cntrctsReport</a></div>
	<div class="menuItem bvl onUsrF" ><a href="#!/xl">Excel</a></div>
	<div class="menuItem bvl onUsrF" ><a href="#!/usrs">Users</a></div>
	<div class="menuItem bvl onUsrF" ><a href="#!/oh">Overheads</a></div>
	<div class="menuItem bvl onUsrF" ><a href="#!/profiles">Profiles</a></div>
	<!--div class="menuItem bvl"><a ng-click="app.logout()" href="#!/login">Logout</a></div-->
</div></span>
<div id="leftDiv" style="z-index:0; min-height: 847px;overflow:visible" ng-app="app">

<main ui-view></main><sub>, by mohamadjb@gmail.com</sub></div>

<templates>

<template id="template.main" >

	<div class="tbl" style="grid-template-columns: repeat(3,1fr)">
		<div class="menuItem"><h2 class="ghost st3d">Contracts Main Menu</h2></div>
		<a ng-click="app.logout()" href="#!/login)" class="menuItem bvl"><div class="menuItem">Logout</div></a> 
		<a ng-click="cntrcts.push(app.cntrct=app.newCntrct())" href="#!/cntrct" class="menuItem bvl"><div class="menuItem">New Contract</div></a>
	</div>
<hr/>
	<div class="tbl hding" style="grid-template-columns: repeat({{app.usr.f?5:4}},1fr);background:rgba(#f0f0ffe0)">
		<div class="menuItem">Jobcard No</div>
		<div class="menuItem"><h3>Title</h3></div>
		<div class="menuItem">Created</div>
		<div class="menuItem">Total</div>
		<div ng-if="app.usr.f" class="menuItem">Net Income</div>
	</div>
	<div ng-repeat="i in cntrcts">
	 <a ng-click="app.cntrct=i" href="#!/cntrct" ng-class="i.ni<=0?'bvl negRow':'bvl'" ng-if="!i.deleted">
	  <div class="tbl" style="grid-template-columns: repeat({{app.usr.f?5:4}},1fr);" >
		<div class="menuItem"><span ng-if="i.closed">&#128274;</span><sub ng-if="i.paid" style="color:red;font-size: small;" class="neon" >PAID</sub>{{i.jn}}</div>
		<div class="menuItem"><h3>{{i.title}}</h3></div>
		<div class="menuItem">{{dt(i.created)|date:"yyyy/MM/dd HH:mm"}}</div>
		<div class="menuItem"><span title="{{i.tc|numberSpelling}}" ng-bind-html="i.tc|filtr:'currency'"></span></div>
		<div ng-if="app.usr.f" ng-class="i.ni<=0?'menuItem negCell':'menuItem'"><span title="{{i.ni|numberSpelling}}" ng-bind-html="i.ni|filtr:'currency'"></span></div>
	</div></a></div>
</template>

<template id="template.cntrct" >
	<h2 class="ghost"><span class="neon">Contract:</span><span class="st3d"><span ng-if="i.closed">&#128274;</span>{{c.title}}</span></h2>
 <input type="button" ng-if="!app.cntrct.closed" ng-click="app.deleteCntrct()" value="&#10062;Delete" />
 <div class="tbl" xstyle="grid-template-columns: repeat(2,1fr)" >
	<div class="menuItem hding" style="text-align:right"><h3>Title</h3></div>
	<div class="menuItem" style="text-align:left" ><h3><input ng-disabled="c.closed" ng-model="c.title" ng-change="app.chng(c)" ng-blur="app.blur(c)"/></h3></div>

	<div class="menuItem hding" style="text-align:right">Contractor</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed" ng-model="c.contractor"
		ng-change="app.chng(c)" ng-blur="app.blur(c)" /></div>

	<div class="menuItem hding" style="text-align:right">Created</div>
	<div class="menuItem" style="text-align:left" >{{dt(c.created)|date:"yyyy/MM/dd HH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Last Modified</div>
	<div class="menuItem" style="text-align:left" >{{dt(c.lastModified)|date:"yyyy/MM/dd HH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Started</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed" type="date" xstyle="width:70%;" ng-model="c.started" ng-change="app.chng(c)" ng-blur="app.blur(c)"/></div>

	<div class="menuItem hding" style="text-align:right">Completed</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed" type="date" xstyle="width:70%;" ng-model="c.completed" ng-change="app.chng(c)" ng-blur="app.blur(c)"/></div>

	<div class="menuItem hding" style="text-align:right">Paid</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed||(c.paid&&!app.usr.f)" xstyle="width:70%;" type="checkbox" ng-model="c.paid" ng-change="app.chng(c)" ng-blur="app.blur(c)"
		/><sub ng-if="c.paid" style="color:red;font-size: small;" class="neon" >PAID</sub></div>

	<div class="menuItem hding" style="text-align:right">Closed</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed&&!app.usr.f" xstyle="width:70%;" type="checkbox" ng-model="c.closed" ng-change="app.chng(c)" ng-blur="app.blur(c)"
		/><span ng-if="c.closed">&#128274;</span></div>

	<div class="menuItem hding" style="text-align:right" 
		title="rate(at the time of the contract creation) is the overhead-sum of the company , divided by total number of operators"
		>Rate</div><div class="menuItem" style="text-align:left"><span 
		title="{{c.rate|numberSpelling}}" ng-bind-html="c.rate|filtr:'currency'"></span></div>

	<div class="menuItem hding" style="text-align:right">Jobcard No</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed" xstyle="width:70%;"
		ng-model="c.jn" type="number" min="0" placeholder="0" step="1" ng-change="app.chng(c)" 
		ng-blur="app.blur(c)"/></div>

	<div class="menuItem hding" style="text-align:right">#Labor</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed||!app.usr.f" xstyle="width:70%;" ng-model="c.ppl" type="number" min="0" placeholder="0" step="1" ng-change="app.chng(c)" ng-blur="app.blur(c)"/></div>

	<div class="menuItem hding" style="text-align:right">#Month</div>
	<div class="menuItem" style="text-align:left" ><input ng-disabled="c.closed||!app.usr.f" xstyle="width:70%;" ng-model="c.month" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)"/></div>

	<div class="menuItem hding" style="text-align:right">Labor cost</div>
	<div class="menuItem" style="text-align:left;display:inline" ><input ng-disabled="c.closed||!app.usr.f" xstyle="width:70%;" ng-model="c.dl" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)" />KD</div>

	<div class="menuItem hding" style="text-align:right">Material</div>
	<div class="menuItem" style="text-align:left;display:inline" ><input ng-disabled="c.closed" xstyle="width:70%;" ng-model="c.dm" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)" />KD</div>

	<div class="menuItem hding" style="text-align:right" ng-if="app.usr.f">SV</div>
	<div class="menuItem" style="text-align:left;display:inline" ng-if="app.usr.f"><input ng-disabled="c.closed" xstyle="width:70%;" ng-model="c.sv" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)" />KD</div>

	<div class="menuItem hding" style="text-align:right">Overhead Cost</div><div class="menuItem" style="text-align:left"><span title="{{c.oh|numberSpelling}}" ng-bind-html="c.oh|filtr:'currency'"></span></div>

	<div class="menuItem hding" style="text-align:right">Total Cost</div><div class="menuItem" style="text-align:left"><span title="{{c.tc|numberSpelling}}" ng-bind-html="c.tc|filtr:'currency'"></span></div>

	<div class="menuItem hding" style="text-align:right">Commission</div>
	<div class="menuItem" style="text-align:left;display:inline" ><input ng-disabled="c.closed||!app.usr.f" xstyle="width:70%;" ng-model="c.cm" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)" />KD</div>

	<div class="menuItem hding" style="text-align:right">Invoice price</div>
	<div class="menuItem" style="text-align:left;display:inline" ><input ng-disabled="c.closed||!app.usr.f" xstyle="width:70%;" ng-model="c.sp" type="number" min="0.000" placeholder="0.000" step="0.001" ng-change="app.chng(c)" ng-blur="app.blur(c)" />KD</div>

	<div class="menuItem hding" style="text-align:right" ng-if="app.usr.f">Owner Income</div>
	<div ng-class="c.ni<=0?'menuItem negCell':'menuItem'" style="text-align:left" ng-if="app.usr.f" ><span title="{{c.ni|numberSpelling}}" ng-bind-html="c.ni|filtr:'currency'"></span></div>

	<div class="menuItem hding" style="text-align:right">Remarks</div>
	<div class="menuItem" style="text-align:left" ><textarea ng-disabled="c.closed" ng-model="c.remarks" ng-change="app.chng(c)" ng-blur="app.blur(c)"></textarea></div>
</div>
</template>


<template id="template.login" >
	<h2>Login to your account</h2>
	<form >
		<input type="text" ng-model="un" placeholder="Username" autofocus ng-change="chng()" />
		<input type="password" ng-model="pw" placeholder="Password"  ng-change="chng()" />
		<input type="button" ng-click="clk()" value="Login" class="bvl" />
	</form>
	{{msg}}
	<div class="cta"><a href="#"><!--Forgot your password?--></a></div>
</template>

<template id="template.oh" >
	<h2 class="st3d">Overheads</h2>
	 <div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

	<div class="menuItem hding" style="text-align:right">Currect Rate</div>
	<div class="menuItem brdr" style="text-align:left" ><input ng-model="app.ls.rate.v"
		type="number" min="0.000" placeholder="0.000" step="0.001" 
		ng-change="app.chng(c)" ng-blur="app.blur(c)" /></div>
</div>
</template>

<template id="template.profiles" >
	<h2 class="st3d">Profiles</h2>
 <input ng-click="app.selectedProfile=app.newProfile()" value="New Profile" type="button"/>
 <select ng-model="app.selectedProfile" ng-options="i.Name for i in app.ls.profiles" ng-change="chngSlct()"></select>

{{app.selectedProfile}}
<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">Name</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Name" type="text" 
	ng-change="chng(sp.Name)" 
	ng-blur="blur(sp.Name)" /></div>

<div class="menuItem hding" style="text-align:right">CID</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.CID" type="integer" 
	ng-change="chng(sp.CID)" 
	ng-blur="blur(sp.CID)" /></div>

<div class="menuItem hding" style="text-align:right">Nationality</div>
<div class="menuItem" style="text-align:left" ><select 
	ng-options="i for i in profileSelects.Nationality"
	ng-model="sp.Nationality" 
	ng-change="chng(sp.Nationality)" 
	ng-blur="blur(sp.Nationality)" >
	</select></div>

<div class="menuItem hding" style="text-align:right">contactInfo</div>
<div class="menuItem" style="text-align:left" >

	<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

	<div class="menuItem hding" style="text-align:right">telNo</div>
	<div class="menuItem" style="text-align:left" >{{sp.contactInfo.telNo.length}}<input 
		ng-model="sp.contactInfo.telNo[0]" type="tel" 
		ng-change="chng(sp.contactInfo.telNo[0])" 
		ng-blur="blur(sp.contactInfo.telNo[0])" /></div>

	<div class="menuItem hding" style="text-align:right">address</div>
	<div class="menuItem" style="text-align:left" >{{sp.contactInfo.address.length}}<input 
		ng-model="sp.contactInfo.address[0]" type="text" 
		ng-change="chng(sp.contactInfo.address[0])" 
		ng-blur="blur(sp.contactInfo.address[0])" /></div>

	<div class="menuItem hding" style="text-align:right">email</div>
	<div class="menuItem" style="text-align:left" >{{sp.contactInfo.email.length}}<input 
		ng-model="sp.contactInfo.email[0]" type="email" 
		ng-change="chng(sp.contactInfo.email[0])" 
		ng-blur="blur(sp.contactInfo.email[0])" /></div></div></div>

<div class="menuItem hding" style="text-align:right">PassportNo</div>
<div class="menuItem" style="text-align:left" >{{sp.PassportNo.length}}<input 
	ng-model="sp.PassportNo[0]" type="integer" 
	ng-change="chng(sp.PassportNo[0])" 
	ng-blur="blur(sp.PassportNo[0])" /></div>

<div class="menuItem hding" style="text-align:right">type</div>
<div class="menuItem" style="text-align:left" ><select 
	ng-model="sp.type" 
	ng-change="chng(sp.type)" 
	ng-blur="blur(sp.type)" >
	<option>operator</option>
	<option>administrator</option>
	<option>contractor</option>
	</select></div>

<div class="menuItem hding" style="text-align:right">JobCategory</div>
<div class="menuItem" style="text-align:left" >{{sp.JobCategory.length}}<select 
	ng-model="sp.JobCategory[0]" 
	ng-change="chng(sp.JobCategory[0])" 
	ng-blur="blur(sp.JobCategory[0])" >
	<option>Mechanical Engineer</option>
	<option>Electrical Engineer</option>
	<option>Instrument Engineer</option>
	<option>Mechanical Supervisor</option>
	<option>Welder –TIG & ARC</option>
	<option>Fabricator</option>
	<option>Valve Technician</option>
	<option>Instrument Technician</option>
	<option>Machinist</option>
	<option>Electrician</option>
	<option>Pipe Fitter</option>
	<option>CNC Operator</option>
	<option>Store Keeper</option>
	<option>General Manager</option>
	<option>Project Manager</option>
	<option>Accountant</option>
	<option>Coordinator</option>
	<option>Secretary</option>
	<option>Receptionist</option>
	<option>Draft man</option>
	<option>Lison Officer (Mandoop)</option>
	<option>Driver</option>
	<option>Care Taker</option>
	</select></div>

<div class="menuItem hding" style="text-align:right">PunchID</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.PunchID" type="integer" 
	ng-change="chng(sp.PunchID)" 
	ng-blur="blur(sp.PunchID)" /></div>

<div class="menuItem hding" style="text-align:right">Date</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">Joining</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Date.Joining" type="date" 
	ng-change="chng(sp.Date.Joining)" 
	ng-blur="blur(sp.Date.Joining)" /></div>

<div class="menuItem hding" style="text-align:right">DOB</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Date.DOB" type="date" 
	ng-change="chng(sp.Date.DOB)" 
	ng-blur="blur(sp.Date.DOB)" /></div></div></div>

<div class="menuItem hding" style="text-align:right">Size</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">shoe</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Size.shoe" type="integer" 
	ng-change="chng(sp.Size.shoe)" 
	ng-blur="blur(sp.Size.shoe)" /></div>

<div class="menuItem hding" style="text-align:right">overall</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Size.overall" type="integer" 
	ng-change="chng(sp.Size.overall)" 
	ng-blur="blur(sp.Size.overall)" /></div></div></div>

<div class="menuItem hding" style="text-align:right">Expiry</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">Passport</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Expiry.Passport" type="date" 
	ng-change="chng(sp.Expiry.Passport)" 
	ng-blur="blur(sp.Expiry.Passport)" /></div>

<div class="menuItem hding" style="text-align:right">CID</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Expiry.CID" type="date" 
	ng-change="chng(sp.Expiry.CID)" 
	ng-blur="blur(sp.Expiry.CID)" /></div>

<div class="menuItem hding" style="text-align:right">Residency</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Expiry.Residency" type="date" 
	ng-change="chng(sp.Expiry.Residency)" 
	ng-blur="blur(sp.Expiry.Residency)" /></div>

<div class="menuItem hding" style="text-align:right">Contract</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Expiry.Contract" type="date" 
	ng-change="chng(sp.Expiry.Contract)" 
	ng-blur="blur(sp.Expiry.Contract)" /></div>

<div class="menuItem hding" style="text-align:right">driverLicense</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Expiry.driverLicense" type="date" 
	ng-change="chng(sp.Expiry.driverLicense)" 
	ng-blur="blur(sp.Expiry.driverLicense)" /></div></div></div>

<div class="menuItem hding" style="text-align:right">freeAttendance</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.freeAttendance" type="checkbox" 
	ng-change="chng(sp.freeAttendance)" 
	ng-blur="blur(sp.freeAttendance)" /></div>

<div class="menuItem hding" style="text-align:right">BankAccountDetailes</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">cash</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.BankAccountDetailes.cash" type="checkbox" 
	ng-change="chng(sp.BankAccountDetailes.cash)" 
	ng-blur="blur(sp.BankAccountDetailes.cash)" /></div>

<div class="menuItem hding" style="text-align:right">bankName</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.BankAccountDetailes.bankName" type="text" 
	ng-change="chng(sp.BankAccountDetailes.bankName)" 
	ng-blur="blur(sp.BankAccountDetailes.bankName)" /></div>

<div class="menuItem hding" style="text-align:right">accountNumber</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.BankAccountDetailes.accountNumber" type="text" 
	ng-change="chng(sp.BankAccountDetailes.accountNumber)" 
	ng-blur="blur(sp.BankAccountDetailes.accountNumber)" /></div></div></div>

<div class="menuItem hding" style="text-align:right">Salary</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">basicSalary</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Salary.basicSalary" type="currency" 
	ng-change="chng(sp.Salary.basicSalary)" 
	ng-blur="blur(sp.Salary.basicSalary)" /></div>

<div class="menuItem hding" style="text-align:right">mobile</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Salary.mobile" type="currency" 
	ng-change="chng(sp.Salary.mobile)" 
	ng-blur="blur(sp.Salary.mobile)" /></div>

<div class="menuItem hding" style="text-align:right">fuel</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Salary.fuel" type="currency" 
	ng-change="chng(sp.Salary.fuel)" 
	ng-blur="blur(sp.Salary.fuel)" /></div>

<div class="menuItem hding" style="text-align:right">Increment</div>
<div class="menuItem" style="text-align:left" ><input 
	ng-model="sp.Salary.Increment" type="currency" 
	ng-change="chng(sp.Salary.Increment)" 
	ng-blur="blur(sp.Salary.Increment)" /></div>

<div class="menuItem hding" style="text-align:right">CustomItems</div>
<div class="menuItem" style="text-align:left" >{{sp.Salary.CustomItems.length}}<input 
	ng-model="sp.Salary.CustomItems[0]" type="currency" 
	ng-change="chng(sp.Salary.CustomItems[0])" 
	ng-blur="blur(sp.Salary.CustomItems[0])" /></div></div></div>

<div class="menuItem hding" style="text-align:right">Attachments</div>
<div class="menuItem" style="text-align:left" >

<div class="tbl" style="grid-template-columns: repeat(2,1fr)" >

<div class="menuItem hding" style="text-align:right">FacePic</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.FacePic.length}}<input 
	ng-model="sp.Attachments.FacePic[0]" type="file" 
	ng-change="chng(sp.Attachments.FacePic[0])" 
	ng-blur="blur(sp.Attachments.FacePic[0])" /></div>

<div class="menuItem hding" style="text-align:right">cid</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.cid.length}}<input 
	ng-model="sp.Attachments.cid[0]" type="file" 
	ng-change="chng(sp.Attachments.cid[0])" 
	ng-blur="blur(sp.Attachments.cid[0])" /></div>

<div class="menuItem hding" style="text-align:right">residency</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.residency.length}}<input 
	ng-model="sp.Attachments.residency[0]" type="file" 
	ng-change="chng(sp.Attachments.residency[0])" 
	ng-blur="blur(sp.Attachments.residency[0])" /></div>

<div class="menuItem hding" style="text-align:right">passport</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.passport.length}}<input 
	ng-model="sp.Attachments.passport[0]" type="file" 
	ng-change="chng(sp.Attachments.passport[0])" 
	ng-blur="blur(sp.Attachments.passport[0])" /></div>

<div class="menuItem hding" style="text-align:right">ministryLabor</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.ministryLabor.length}}<input 
	ng-model="sp.Attachments.ministryLabor[0]" type="file" 
	ng-change="chng(sp.Attachments.ministryLabor[0])" 
	ng-blur="blur(sp.Attachments.ministryLabor[0])" /></div>

<div class="menuItem hding" style="text-align:right">driverLicense</div>
<div class="menuItem" style="text-align:left" >{{sp.Attachments.driverLicense.length}}<input 
	ng-model="sp.Attachments.driverLicense[0]" type="file" 
	ng-change="chng(sp.Attachments.driverLicense[0])" 
	ng-blur="blur(sp.Attachments.driverLicense[0])" /></div></div>
</div>
</div>
</template>

<template id="template.cntrctsReport" >
	<h2 class="st3d">cntrctsReport</h2>

	<div class="tbl" style="grid-template-columns: repeat(4,1fr)">
		<div class="menuItem"><label for="from">From</label><input id="from" type="date" ng-model="from"/></div>
		<div class="menuItem"><label for="to">To</label><input id="to" type="date" ng-model="to"/></div>
		<div class="menuItem"><label for="paid">Paid-statues</label><select ng-model="paid" id="paid" ng-options='i  for i in PType'></select></div>
		<div class="menuItem bvl" ng-click="search()" >Search</div>
	</div>

	<div class="tbl hding" style="grid-template-columns: repeat(11,1fr)">
		<div class="menuItem">Jobcard No.</div>
		<div class="menuItem">Title</div>
		<div class="menuItem">Created</div>
		<div class="menuItem">Labor</div>
		<div class="menuItem">Material</div>
		<div class="menuItem">Sv</div>
		<div class="menuItem">Overhead</div>
		<div class="menuItem">Total-cost</div>
		<div class="menuItem">Commission</div>
		<div class="menuItem">Invoice-price</div>
		<div class="menuItem">Owner Income</div>
	</div>

	<div style="grid-template-columns: repeat(11,1fr)" ng-repeat=" c in a" ng-class="c.ni<=0?'tbl brdr negRow':'tbl brdr'">
		<div class="menuItem">{{c.jn}}</div>
		<div class="menuItem">{{c.title}}</div>
		<div class="menuItem">{{dt(c.created)| date:"yyyy/MM/dd HH:mm"}}</div>
		<div class="menuItem"><span title="{{c.dl|numberSpelling}}" ng-bind-html="c.dl|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.dm|numberSpelling}}" ng-bind-html="c.dm|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.sv|numberSpelling}}" ng-bind-html="c.sv|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.oh|numberSpelling}}" ng-bind-html="c.oh|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.tc|numberSpelling}}" ng-bind-html="c.tc|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.cm|numberSpelling}}" ng-bind-html="c.cm|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{c.sp|numberSpelling}}" ng-bind-html="c.sp|filtr:'currency'"></span></div>
		<div ng-class="c.ni<=0?'menuItem negCell':'menuItem'"><span title="{{c.ni|numberSpelling}}" ng-bind-html="c.ni|filtr:'currency'"></span></div>
	</div>

	<div class="tbl hding" style="grid-template-columns: repeat(11,1fr)">
		<div class="menuItem">rows:{{a.length}}</div>
		<div class="menuItem"><!-- n g-class="sum<=0?'menuItem negCell':'menuItem'">Total-sum:<span title="{ {sum|numberSpelling} }" ng-bind-html="sum|filtr:'currency'"></span--></div>
		<div class="menuItem">Totals:</div>
		<div class="menuItem"><span title="{{b[0].sum|numberSpelling}}" ng-bind-html="b[0].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[1].sum|numberSpelling}}" ng-bind-html="b[1].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[2].sum|numberSpelling}}" ng-bind-html="b[2].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[3].sum|numberSpelling}}" ng-bind-html="b[3].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[4].sum|numberSpelling}}" ng-bind-html="b[4].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[5].sum|numberSpelling}}" ng-bind-html="b[5].sum|filtr:'currency'"></span></div>
		<div class="menuItem"><span title="{{b[6].sum|numberSpelling}}" ng-bind-html="b[6].sum|filtr:'currency'"></span></div>
		<div ng-class="b[7].sum<=0?'menuItem negCell':'menuItem'"><span title="{{b[7].sum|numberSpelling}}" ng-bind-html="b[7].sum|filtr:'currency'"></span></div>
	</div>
</template>


<template id="template.usrs" >
	<h2 class="ghost"><span class="neon">Users:</span><span class="st3d">{{editUsr.un}}</span></h2>
	<select ng-model="editUsr" ng-options="c.un for c in app.ls.usr" ng-change="chng(c)"></select>
	<input type="button" ng-click="editUsr=app.newUsr()" value="New User"/>
 <div class="tbl" style="grid-template-columns: repeat(2,1fr)" ng-if="editUsr && !editUsr.deleted" >

	<div class="menuItem hding" style="text-align:right">User-name</div>
	<div class="menuItem" style="text-align:left" ><input type="button" ng-click="app.deleteEditUsr()" value="&#10062;Delete" /><h3>{{editUsr.un}}</h3></div>

	<div class="menuItem hding" style="text-align:right">First-name</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.firstName" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Last-name</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.lastName" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">E-Mail</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.email" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Telephone</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.tel" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Profile</div>
	<div class="menuItem" style="text-align:left" ><select 
		ng-options="i.Name for i in app.ls.profiles"
		ng-change="app.chng(editUsr)" 
		ng-blur="app.blur(editUsr)"
		ng-model="editUsr.profile" ></select></div>

	<div class="menuItem hding" style="text-align:right">Super-user</div>
	<div class="menuItem" style="text-align:left" ><input type="checkbox" ng-model="editUsr.f" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Remarks</div>
	<div class="menuItem" style="text-align:left" ><textarea ng-model="editUsr.notes" ng-change="app.chng(editUsr)" ng-blur="app.blur(editUsr)"></textarea></div>

	<div class="menuItem hding" style="text-align:right">Last Modified</div>
	<div class="menuItem" style="text-align:left" >{{dt(editUsr.lastModified)|date:"yyyy/MM/ddTHH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Created</div>
	<div class="menuItem" style="text-align:left" >{{dt(editUsr.created)|date:"yyyy/MM/ddTHH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Created by</div>
	<div class="menuItem" style="text-align:left" >{{editUsr.usr}}</div>
</div>
</template>


<template id="template.xl" >
<script type="text/ng-template" id="/cntrct.html" >
<tr>
	<td class="not_menuItem hding" style="text-align:right"><h3>Title</h3></td>
	<td class="not_menuItem" style="text-align:left" ><h3>{{c.title}}</h3></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Contractor</td>
	<td class="not_menuItem" style="text-align:left" >{{c.contractor}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Created</td>
	<td class="not_menuItem" style="text-align:left" >{{dt(c.created)|date:"yyyy/MM/dd HH:mm"}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Last Modified</td>
	<td class="not_menuItem" style="text-align:left" >{{dt(c.lastModified)|date:"yyyy/MM/dd HH:mm"}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Started</td>
	<td class="not_menuItem" style="text-align:left" >{{c.started}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Completed</td>
	<td class="not_menuItem" style="text-align:left" >{{c.completed}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Paid</td>
	<td class="not_menuItem" style="text-align:left" ><sub ng-if="c.paid" style="color:red;font-size: small;" class="neon" >PAID</sub></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Closed</td>
	<td class="not_menuItem" style="text-align:left" ><span ng-if="c.closed">&#128274;</span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right" 
		title="rate(at the time of the contract creation) is the overhead-sum of the company , divided by total number of operators"
		>Rate</td><td class="not_menuItem" style="text-align:left"><span 
		title="{{c.rate|numberSpelling}}" ng-bind-html="c.rate|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Jobcard No</td>
	<td class="not_menuItem" style="text-align:left" >{{c.jn}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">#Labor</td>
	<td class="not_menuItem" style="text-align:left" >{{c.ppl}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">#Month</td>
	<td class="not_menuItem" style="text-align:left" >{{c.month}}</td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Labor cost</td>
	<td class="not_menuItem" style="text-align:left" ><span 
		title="{{c.dl|numberSpelling}}" ng-bind-html="c.dl|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Material</td>
	<td class="not_menuItem" style="text-align:left" ><span 
		title="{{c.dm|numberSpelling}}" ng-bind-html="c.dm|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right" ng-if="app.usr.f">SV</td>
	<td class="not_menuItem" style="text-align:left" ng-if="app.usr.f"><span 
		title="{{c.sv|numberSpelling}}" ng-bind-html="c.sv|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Overhead Cost</td><td class="not_menuItem" style="text-align:left"><span title="{{c.oh|numberSpelling}}" ng-bind-html="c.oh|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Total Cost</td><td class="not_menuItem" style="text-align:left"><span title="{{c.tc|numberSpelling}}" ng-bind-html="c.tc|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Commission</td>
	<td class="not_menuItem" style="text-align:left" ><span 
		title="{{c.cm|numberSpelling}}" ng-bind-html="c.cm|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Invoice price</td>
	<td class="not_menuItem" style="text-align:left" ><span 
		title="{{c.sp|numberSpelling}}" ng-bind-html="c.sp|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right" ng-if="app.usr.f">Owner Income</td>
	<td ng-class="c.ni<=0?'not_menuItem negCell':'not_menuItem'" style="text-align:left" ng-if="app.usr.f" ><span title="{{c.ni|numberSpelling}}" ng-bind-html="c.ni|filtr:'currency'"></span></td>

	</tr><tr><td class="not_menuItem hding" style="text-align:right">Remarks</td>
	<td class="not_menuItem" style="text-align:left" ><pre>{{c.remarks}}</pre></td>
</tr>
<tr><td>eSignature</td><td><pre style="font-size: 6px;"> <!-- { { c | json }} --> {{ signature(c) }} </pre></td></tr>
<tr><td colspan="2"><hr/></td></tr><tr><td colspan="2"><hr/></td></tr>
</script>
<script type="text/javascript" src="xlContract.js"></script>
<style>
.xport, .btn {
	display: inline;
	text-align:center;
}
a { text-decoration: none }
#drop_zone {
  border: 5px dashed #ccc;
  width:  200px;
  height: 100px;
}
</style>

<button class="menuItem bvl " ng-click="refreshFileList()">Refresh server file-list</button>	
<table>
<tr><th>file-name</th><th>file-size</th><th>file-date</th></tr>
<tr ng-repeat="f in xl.fileList"  style="border-top:3px double blue">
	<td style="border-top:3px double blue">
		<span ng-if="f.fileName==app.ls.fileName">
			<h2>{{f.fileName}}</h2>
			<button class="menuItem bvl " ng-click="saveToServer(f.fileName)">Save to Server</button>
		</span>
		<span ng-if="f.fileName!=app.ls.fileName">
			<button ng-click="loadFile(f)">Load</button>
			{{f.fileName}}
		</span>
	</td>
	<td>{{f.size}}</td>
	<td>{{dt(f.lastModified) }}</td>
</tr>

<tr style="border:3px double black">
<td style="border-top:3px double blue"><hr/>
	<input ng-model="xl.fileName"/>
	<button class="menuItem bvl " ng-click="saveToServer()">Save new file to Server</button>
</td><td></td><td>{{dt(app.lsSaved) }}</td>
</tr>
</table>
<hr/>
<div id="drop_zone" 
	ondrop="drop_handler(event);" 
	ondragover="dragover_handler(event);"
	ondragend="dragend_handler(event);"
	>
  <strong>Drag excel file to this Drop Zone ...</strong>
  <progress id="progress" value=0>%</progress>
</div><div id="results">

  <span id="drop_zone_results">-</span>
  <select ng-model="mode" ng-options=""></select> </div>
<hr/>
	scheduled save-to-server <hr/>
<button class="menuItem bvl " onclick="doit()">Download as Excel file</button>
<span id="xlExp" onclick="var x=did('xltable'),s=x.style,d=s.display;s.display=d?'':'none'">+</span>
<table id="xltable" style="display:none">
<tbody ng-repeat="c in app.ls.contracts" ng-include="'/cntrct.html'"></tbody>
</table>

</template>

</templates><div data-ng-if="loading"><!--Loading...--></div>
</body></html>
