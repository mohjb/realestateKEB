<!DOCTYPE><html>
<head>
<link href="favic32.ico" rel="shortcut icon" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/angular-1.6.4/angular.min.js"></script>
<script src="/angular-1.6.4/angular-sanitize.min.js"></script>
<script src="/angular-1.6.4/angular-md5.js"></script>
<script src="/angular-1.6.4/angular-ui-router.js"></script>
<script src="main2.js"></script>

<title>by mohamadjb@gmail.com</title>
<link rel="stylesheet" href="main.css">

</head>

<body class="grad">

<img class="onLoggedOut" src="logo.png">
<span class="onLoggedIn"><div width="100%" style="display:inline-flex ;
    grid-gap: 3px;
    grid-auto-rows: minmax(100px,auto);
    grid-template-columns: repeat({{main.usr.f?6:2}},1fr);
    background: rgba(240,240,255,.1);
    border-radius: 5px;
    padding: 3px;">
	<div class="menuItem" style="min-width:300px"><img src="logo.png"></div>
	<h1>Server-side</h1>
	<div class="menuItem bvl"><a href="#!/main">Apps</a></div>
</div>
</span>
<div id="leftDiv" style="z-index:0; min-height: 847px;overflow:visible" ng-app="main">
	<main ui-view></main><sub>, by mohamadjb@gmail.com</sub>
</div>

<templates>

<template id="template.main" >
	<a ng-click="main.logout()" href="#!/login)" 
		class="menuItem bvl"><div class="menuItem">Logout</div></a>
	<h2>Apps</h2><select ng-model="main.selected.app"
		ng-change="main.selectedChanged('app')"
		ng-options="x.app for x in main.aps.apsList"></select>
		<input type="button" value="refresh-List" ng-click="refresh('appsList')"/>
		<input type="button" value="refresh-App" ng-click="refresh('app')"/>
		<input type="button" value="new" ng-click="onNew('app')"/>
<hr/>

<!--h2 onclick="x=did('jspUrls');s=x.style;s.display=s.display?'':'none'"
	>Jsp-Urls<sub>(App={{app.selected.app.title}})</sub></h2>
<div id="jspUrls" style="display:none"><select ng-model="main.selected.JspUrl" 
		ng-change="main.selectedChanged('JspUrl')"
		ng-options="x.title for x in main.selected.app.JspUrls"></select>
		<input type="button" value="new" ng-click="onNew('JspUrl')"/>
</div>

<hr/>

<h2 onclick="x=did('AngularUrl');s=x.style;s.display=s.display?'':'none'"
	>AngularJsApp-Urls<sub>(App={{main.selected.app.title}})</sub></h2>
<div id="AngularUrl" style="display:none"><select ng-model="main.selected.AngularUrl" 
		ng-change="main.selectedChanged('AngularUrl')"
		ng-options="x.title for x in main.selected.app.AngularUrls"></select>
		<input type="button" value="new" ng-click="onNew('AngularUrl')"/>
</div-->

<h2>JsonStorageApp keys</h2>
<table border=1 >
<tr><th>key-name</th><th>typ</th><th>val</th></tr>
<tr ng-repeat="j in main.selected.app.keys">
<td >{{j.key }}
	<input type="button" ng-click="clkDelKey(j)" value="delete"/>
	<input type="button" ng-click="serverAccess(j)" ng-if="j.typ=='serverSideJs'" value="serverAccess"/>
	</td>
<td ><select ng-model="j.typ" ng-options="i for i in ct"></select></td>
<td ><textarea ng-model="j.val" ng-change="chng(j)" ng-blur="blur(j)">{{j.val }}</textarea>
</td>
</tr>
<tfoot style="background-color:green"><tr>
<td ng-init="newKey={app:main.selected.app.title}"><input ng-model="newKey.key"/></td>
<td ><select ng-model="newKey.typ" ng-options="i for i in ct"></select></td>
<td ><textarea ng-model="newKey.val"></textarea>
<input type="button" ng-click="onNew('key',newKey)" value="create"/></td>
</tr></tfoot>
</table>
<input type="button" value="refresh" ng-click="refresh('key')"/>

<hr/>
<h2>JsonStorateApp Rhino-eval</h2>
<textarea ng-model="rhinoEvalSrc"></textarea>
<input type="button" value="run" ng-click="rhinoEvalRun(rhinoEvalSrc)"/>
<pre ng-model="rhinoEvalResult"></pre>
</template>

<template id="template.login" >
	<h2>Login to your account</h2>
	<form >
		<input type="text" ng-model="un" placeholder="Username" autofocus ng-change="chng()" />
		<input type="password" ng-model="pw" placeholder="Password"  ng-change="chng()" />
		<input type="button" ng-click="clk()" value="Login" class="bvl" />
	</form>
	{{msg}}
	<div class="cta"><a href="#"><!--Forgot your password?--></a></div>
</template>

<template id="template.usrs" >
	<h2 class="ghost"><span class="neon">Users:</span><span class="st3d">{{editUsr.un}}</span></h2>
	<select ng-model="editUsr" ng-options="c.un for c in main.aps.usrs" ng-change="chng(c)"></select>
	<input type="button" ng-click="editUsr=main.newUsr()" value="New User"/>
 <div class="tbl" style="grid-template-columns: repeat(2,1fr)" ng-if="editUsr && !editUsr.deleted" >

	<div class="menuItem hding" style="text-align:right">User-name</div>
	<div class="menuItem" style="text-align:left" ><input type="button" ng-click="main.deleteEditUsr()" value="&#10062;Delete" /><h3>{{editUsr.un}}</h3></div>

	<div class="menuItem hding" style="text-align:right">First-name</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.firstName" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Last-name</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.lastName" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">E-Mail</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.email" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Telephone</div>
	<div class="menuItem" style="text-align:left" ><input ng-model="editUsr.tel" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Super-user</div>
	<div class="menuItem" style="text-align:left" ><input type="checkbox" ng-model="editUsr.f" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"/></div>

	<div class="menuItem hding" style="text-align:right">Remarks</div>
	<div class="menuItem" style="text-align:left" ><textarea ng-model="editUsr.notes" ng-change="main.chng(editUsr)" ng-blur="main.blur(editUsr)"></textarea></div>

	<div class="menuItem hding" style="text-align:right">Last Modified</div>
	<div class="menuItem" style="text-align:left" >{{dt(editUsr.lastModified)|date:"yyyy/MM/ddTHH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Created</div>
	<div class="menuItem" style="text-align:left" >{{dt(editUsr.created)|date:"yyyy/MM/ddTHH:mm"}}</div>

	<div class="menuItem hding" style="text-align:right">Created by</div>
	<div class="menuItem" style="text-align:left" >{{editUsr.usr}}</div>
</div>
</template>

</templates><div ng-if="loading"><!--Loading...--></div>
</body></html>
